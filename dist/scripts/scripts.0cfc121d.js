function radialProgress(a){function b(){function a(a){"function"==typeof i&&i.call()}g.each(function(b){function g(a){var b=(p-q)/(r-q),f=Math.min(360*b,360);f=f*Math.PI/180,u.datum(f),u.transition().duration(j).attrTween("d",d),b>1&&(x.datum(Math.min(360*(b-1),360)*Math.PI/180),x.transition().delay(j).duration(j).attrTween("d",e)),y.datum(Math.round(100*b)),y.transition().duration(j).tween("text",c)}var h=d3.select(this).selectAll("svg").data([b]),i=h.enter().append("svg").attr("class","radial-svg").append("g");f(),h.attr("width",l).attr("height",m);var t=i.append("g").attr("class","component").attr("cursor","pointer").on("click",a);v.endAngle(360*(Math.PI/180)),t.append("rect").attr("class","background").attr("width",_width).attr("height",_height),t.append("path").attr("transform","translate("+_width/2+","+_width/2+")").attr("d",v),t.append("text").attr("class","label").attr("transform","translate("+_width/2+","+(_width+o)+")").text(n);h.select("g").attr("transform","translate("+k.left+","+k.top+")");v.endAngle(s),i.append("g").attr("class","arcs");var u=h.select(".arcs").selectAll(".arc").data(b);u.enter().append("path").attr("class","arc").attr("transform","translate("+_width/2+","+_width/2+")").attr("d",v);var x=h.select(".arcs").selectAll(".arc2").data(b);x.enter().append("path").attr("class","arc2").attr("transform","translate("+_width/2+","+_width/2+")").attr("d",w),i.append("g").attr("class","labels");var y=h.select(".labels").selectAll(".label").data(b);y.enter().append("text").attr("class","label").attr("y",_width/2+o/3).attr("x",_width/2).attr("cursor","pointer").attr("width",_width).text(function(a){return Math.round((p-q)/(r-q)*100)+"%"}).style("font-size",o+"px").on("click",a),u.exit().transition().duration(500).attr("x",1e3).remove(),g(h)})}function c(a){var b=d3.interpolate(u,a);return u=b(0),function(a){u=b(a),this.textContent=Math.round(b(a))+"%"}}function d(a){var b=d3.interpolate(s,a);return function(a){return s=b(a),v.endAngle(b(a))()}}function e(a){var b=d3.interpolate(t,a);return function(a){return w.endAngle(b(a))()}}function f(){_width=h-k.right-k.left-k.top-k.bottom,_height=_width,o=.2*_width,v.outerRadius(_width/2),v.innerRadius(_width/2*.85),w.outerRadius(_width/2*.85),w.innerRadius(_width/2*.85-_width/2*.15)}var g,h,i,j=3e3,k={top:0,right:0,bottom:30,left:0},l=125,m=125,n="",o=10,p=0,q=0,r=100,s=0,t=0,u=0,v=d3.svg.arc().startAngle(0*(Math.PI/180)),w=d3.svg.arc().startAngle(0*(Math.PI/180)).endAngle(0);return g=d3.select(a),b.render=function(){return f(),b(),b},b.value=function(a){return arguments.length?(p=[a],g.datum([p]),b):p},b.margin=function(a){return arguments.length?(k=a,b):k},b.diameter=function(a){return arguments.length?(h=a,b):h},b.minValue=function(a){return arguments.length?(q=a,b):q},b.maxValue=function(a){return arguments.length?(r=a,b):r},b.label=function(a){return arguments.length?(n=a,b):n},b._duration=function(a){return arguments.length?(j=a,b):j},b.onClick=function(a){return arguments.length?(i=a,b):i},b}!function(a,b,c){"use strict";"function"==typeof define&&define.amd?define([],c):"object"==typeof exports?module.exports=c():b[a]=c()}("Please",this,function(){"use strict";function a(){function a(a,b,c){var d=Math.random;return c instanceof g&&(d=c.random),Math.floor(d()*(b-a+1))+a}function b(a,b,c){var d=Math.random;return c instanceof g&&(d=c.random),d()*(b-a)+a}function c(a,b,c){return Math.max(b,Math.min(a,c))}function d(a,b){var c;switch(a){case"hex":for(c=0;c<b.length;c++)b[c]=h.HSV_to_HEX(b[c]);break;case"rgb":for(c=0;c<b.length;c++)b[c]=h.HSV_to_RGB(b[c]);break;case"rgb-string":for(c=0;c<b.length;c++){var d=h.HSV_to_RGB(b[c]);b[c]="rgb("+d.r+","+d.g+","+d.b+")"}break;case"hsv":break;default:console.error("Format not recognized.")}return b}function e(a){var b=h.HSV_to_RGB(a),c=(299*b.r+587*b.g+114*b.b)/1e3;return c>=128?"dark":"light"}function f(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function g(a){function b(){d=(d+1)%256,e=(e+c[d])%256;var a=c[d];return c[d]=c[e],c[e]=a,c[(c[d]+c[e])%256]}for(var c=[],d=0,e=0,f=0;256>f;f++)c[f]=f;for(var g=0,h=0;256>g;g++){h=(h+c[g]+a.charCodeAt(g%a.length))%256;var i=c[g];c[g]=c[h],c[h]=i}this.random=function(){for(var a=0,c=0,d=1;8>a;a++)c+=b()*d,d*=256;return c/0x10000000000000000}}var h={},i={aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgrey:"A9A9A9",darkgreen:"006400",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",grey:"808080",green:"008000",greenyellow:"ADFF2F",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgrey:"D3D3D3",lightgreen:"90EE90",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370D8",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"D87093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",rebeccapurple:"663399",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"},j=.618033988749895,k={hue:null,saturation:null,value:null,base_color:"",greyscale:!1,grayscale:!1,golden:!0,full_random:!1,colors_returned:1,format:"hex",seed:null},l={scheme_type:"analogous",format:"hex"},m={golden:!1,format:"hex"};return h.NAME_to_HEX=function(a){return a=a.toLowerCase(),a in i?i[a]:void console.error("Color name not recognized.")},h.NAME_to_RGB=function(a){return h.HEX_to_RGB(h.NAME_to_HEX(a))},h.NAME_to_HSV=function(a){return h.HEX_to_HSV(h.NAME_to_HEX(a))},h.HEX_to_RGB=function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null},h.RGB_to_HEX=function(a){return"#"+((1<<24)+(a.r<<16)+(a.g<<8)+a.b).toString(16).slice(1)},h.HSV_to_RGB=function(a){var b,c,d,e,f,g,h,i,j=a.h,k=a.s,l=a.v;if(0===k)return{r:l,g:l,b:l};switch(j/=60,e=Math.floor(j),f=j-e,g=l*(1-k),h=l*(1-k*f),i=l*(1-k*(1-f)),e){case 0:b=l,c=i,d=g;break;case 1:b=h,c=l,d=g;break;case 2:b=g,c=l,d=i;break;case 3:b=g,c=h,d=l;break;case 4:b=i,c=g,d=l;break;case 5:b=l,c=g,d=h}return{r:Math.floor(255*b),g:Math.floor(255*c),b:Math.floor(255*d)}},h.RGB_to_HSV=function(a){var b=a.r/255,c=a.g/255,d=a.b/255,e=0,f=0,g=0,h=Math.min(b,Math.min(c,d)),i=Math.max(b,Math.max(c,d));if(h===i)return g=h,{h:0,s:0,v:g};var j=b===h?c-d:d===h?b-c:d-b,k=b===h?3:d===h?1:5;return e=60*(k-j/(i-h)),f=(i-h)/i,g=i,{h:e,s:f,v:g}},h.HSV_to_HEX=function(a){return h.RGB_to_HEX(h.HSV_to_RGB(a))},h.HEX_to_HSV=function(a){return h.RGB_to_HSV(h.HEX_to_RGB(a))},h.make_scheme=function(a,b){function e(a){return{h:a.h,s:a.s,v:a.v}}var g,h,i,j,k,m=f(l);if(null!==b)for(var n in b)b.hasOwnProperty(n)&&(m[n]=b[n]);var o=[a];switch(m.scheme_type.toLowerCase()){case"monochromatic":case"mono":for(k=1;2>=k;k++)g=e(a),i=g.s+.1*k,i=c(i,0,1),j=g.v+.1*k,j=c(j,0,1),g.s=i,g.v=j,o.push(g);for(k=1;2>=k;k++)g=e(a),i=g.s-.1*k,i=c(i,0,1),j=g.v-.1*k,j=c(j,0,1),g.s=i,g.v=j,o.push(g);break;case"complementary":case"complement":case"comp":g=e(a),g.h=(g.h+180)%360,o.push(g);break;case"split-complementary":case"split-complement":case"split":g=e(a),g.h=(g.h+165)%360,o.push(g),g=e(a),g.h=Math.abs((g.h-165)%360),o.push(g);break;case"double-complementary":case"double-complement":case"double":g=e(a),g.h=(g.h+180)%360,o.push(g),g.h=(g.h+30)%360,h=e(g),o.push(g),g.h=(g.h+180)%360,o.push(h);break;case"analogous":case"ana":for(k=1;5>=k;k++)g=e(a),g.h=(g.h+20*k)%360,o.push(g);break;case"triadic":case"triad":case"tri":for(k=1;3>k;k++)g=e(a),g.h=(g.h+120*k)%360,o.push(g);break;default:console.error("Color scheme not recognized.")}return d(m.format.toLowerCase(),o),o},h.make_color=function(e){var i=[],l=f(k),m=null;if(null!==e)for(var n in e)e.hasOwnProperty(n)&&(l[n]=e[n]);var o=null;"string"==typeof l.seed&&(o=new g(l.seed)),l.base_color.length>0&&(m=l.base_color.match(/^#?([0-9a-f]{3})([0-9a-f]{3})?$/i)?h.HEX_to_HSV(l.base_color):h.NAME_to_HSV(l.base_color));for(var p=0;p<l.colors_returned;p++){var q,r,s,t=a(0,360,o);null!==m?(q=c(a(m.h-5,m.h+5,o),0,360),r=0===m.s?0:b(.4,.85,o),s=b(.4,.85,o),i.push({h:q,s:r,v:s})):(q=l.greyscale===!0||l.grayscale===!0?0:l.golden===!0?(t+t/j)%360:null===l.hue||l.full_random===!0?t:c(l.hue,0,360),r=l.greyscale===!0||l.grayscale===!0?0:l.full_random===!0?b(0,1,o):null===l.saturation?.4:c(l.saturation,0,1),s=l.full_random===!0?b(0,1,o):l.greyscale===!0||l.grayscale===!0?b(.15,.75,o):null===l.value?.75:c(l.value,0,1),i.push({h:q,s:r,v:s}))}return d(l.format.toLowerCase(),i),i},h.make_contrast=function(a,b){var g=f(m);if(null!==b)for(var i in b)b.hasOwnProperty(i)&&(g[i]=b[i]);var k,l,n=e(a);if(g.golden===!0)l=a.h*(1+j)%360;else{var o=h.make_scheme(a,{scheme_type:"complementary",format:"hsv"})[1];l=c(o.h-30,0,360)}var p;return"dark"===n?p=c(a.v-.25,0,1):"light"===n&&(p=c(a.v+.25,0,1)),k=[{h:l,s:a.s,v:p}],d(g.format.toLowerCase(),k),k[0]},h}return a()});var app=angular.module("asecApp",["ngMaterial","ngRoute","perfect_scrollbar","contentful"]);app.config(["contentfulProvider",function(a){a.setOptions({space:"ln1xrgztle3b",accessToken:"f308ed71e5310a68f2547d8696ae5c4e4e20c466073c047d61f2b983c896f8fa"})}]),app.config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode(!0),a.when("/",{templateUrl:"/views/home.html",controller:"homeCTL",redirectTo:function(a,b,c){return c["goto"]?"/"+c["goto"]:"/"}}).when("/municipio/:municipioId",{templateUrl:"/views/municipio.html",controller:"municipioCTL"}).otherwise({redirectTo:"/"})}]),angular.module("asecApp").controller("MainCtrl",["$scope","contentful",function(a,b){b.entry("4wpFvBKx5mo0wgIc4UcWgK").then(function(b){a.mainContent=b.data.fields,console.log("loaded main content")}),a.mainContent=["HTML5 Boilerplate","AngularJS","Karma"]}]),app.controller("homeCTL",["$scope","$http","$location","$rootScope",function(a,b,c,d){a.isLoaded=!1,a.municipios=[],a.municipiosCoords=[],a.bubbleChartData=[],a.getMunicipiosStats=function(){for(var c=38,d="http://desarrollo.optimit.com.mx/auditoria_coahuila/web_service.php?accion=get_n_entidades_todos_datos&id_entidad=",e="",f=1;c+1>f;f++)e+=f===c?f:f+",";var g=d+e+"&callback=JSON_CALLBACK";b.jsonp(g).success(function(b){_.each(b,function(b){b&&a.municipios.push(b)}),a.isLoaded=!0,a.bubbleChartData=a.municipios,a.drawState()}).error(function(a){})},a.getMunicipiosData=function(){b.get("/municipios.json").success(function(b){a.municipiosCoords=b,a.getMunicipiosStats()}).error(function(a){})},a.getTooltip=function(a){a.cumplimiento=.65;var b="<p><strong>"+a.name+"</strong></p>";return b+="<hr/>",b+="<p>Porcentaje de cumplimiento: "+a.cumplimiento+"%</p>"},a.processData=function(a){var b=[],c=50;return _.each(a,function(a){b.push({name:a.name,lat:a.coords.lat,lng:a.coords.lng,id:a.id,size:.6*c})}),{children:b}},a.drawState=function(){d3.select(window).on("resize",s);var b,e,f,g,h,i,j,k,l=function(){var a=d3.event.translate,b=d3.event.scale,c=o/3;a[0]=Math.min(n/2*(b-1),Math.max(n/2*(1-b),a[0])),a[1]=Math.min(o/2*(b-1)+c*b,Math.max(o/2*(1-b)-c*b,a[1])),m.translate(a),j.attr("transform","translate("+a+")scale("+b+")"),j.attr("r",function(a){return a.size/b}),i.attr("transform","translate("+a+")scale("+b+")")},m=d3.behavior.zoom().scaleExtent([1,8]).on("zoom",l),n=$("#data-map-home").width(),o=n,p=function(){var b=d3.tip().attr("class","bubble-chart-tip map-tip").offset([-10,0]).html(function(b){return a.getTooltip(b)});g.call(b);var f=a.processData(a.municipiosCoords),h=d3.layout.pack().size([n,o]).padding(8).value(function(a){return a.size}),i=h.nodes(f).filter(function(a){return!a.children}),k=g.selectAll("circle").data(i,function(a){return a.name}),l=50;j=k.enter().append("circle").attr("cx",function(a){var b=[a.lng,a.lat],c=e(b);return c[0]}).attr("cy",function(a){var b=[a.lng,a.lat],c=e(b);return c[1]}).attr("r",function(){return.6*l}).attr("opacity",.8).style("stroke","#2A82B4").style("fill","#2A82B4").on("mouseover",function(a){b.show(a)}).on("mouseout",function(a){b.hide(a)}).on("click",function(a){d.$apply(function(){c.path("/municipio/"+a.id)})})},q=function(a){console.log(a),i=h.selectAll("#data-map-home path").data(a),i.enter().append("path").attr("class","mun").attr("d",f);document.getElementById("data-map-home").offsetLeft+n/2+40,document.getElementById("data-map-home").offsetTop+o/2+20;p()},r=function(){n=document.getElementById("data-map-home").width,o=n,d3.select("#data-map-home svg").remove(),t(n,o),q(b)},s=function(){window.clearTimeout(k),k=window.setTimeout(function(){r()},200)},t=function(a,b){var c=[-102.077342,27.226009];e=d3.geo.mercator().translate([0,0]).center(c).scale(6e3),f=d3.geo.path().projection(e),g=d3.select("#data-map-home").append("svg").attr("width",a).attr("height",b).append("g").attr("transform","translate("+a/2+","+b/2+")").call(m),console.log(m),g.call(m),h=g.append("g")};t(n,o),d3.json("/mx_tj.json",function(a,c){var d=topojson.feature(c,c.objects.municipalities).features.filter(function(a){return 5===a.properties.state_code});b=d,q(b)})},a.getMunicipiosData()}]),app.controller("municipioCTL",["$scope","$http","$routeParams",function(a,b,c){a.municipioId=c.municipioId,a.municipio={},a.isLoaded=!1,a.drawRadial=function(){radialProgress(document.getElementById("ingreso-per-capita")).diameter(150).value(78).render(),radialProgress(document.getElementById("egreso-per-capita")).diameter(150).value(82).render()},a.getMunicipio=function(){var c="http://desarrollo.optimit.com.mx/auditoria_coahuila/web_service.php?accion=get_entidad_todos_datos&id_entidad=",d=a.municipioId,e=c+d+"&callback=JSON_CALLBACK";b.jsonp(e).success(function(b){console.log(b),a.municipio=b[d],a.isLoaded=!0,a.drawRadial()}).error(function(a){})},a.getMunicipio()}]),function(){var a=function(a,b,c,d){var e;a.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a.getRandomColor=function(){var b=["red","blue","orange"],c=a.getRandomInt(0,b.length-1),d=Please.make_color({base_color:b[c]});return d[0]},a.processData=function(b){var c=[];return _.each(b,function(b){c.push({name:b.datos_entidad.nombre_completo,className:b.datos_entidad.nombre_completo.toLowerCase(),size:b.li_pe.pe_oficial,opacity:1-b.porcentaje_cumplimiento,cumplimiento:b.porcentaje_cumplimiento,resourceId:b.datos_entidad.id,fillColor:a.getRandomColor()})}),{children:c}},a.getTooltip=function(a){var c="<p><strong>"+a.name+"</strong></p>";return c+="<hr/>",c+="<p>Porcentaje de cumplimiento: "+a.cumplimiento+"%</p>",c+="<p>PE oficial:</p>",c+='<p><strong class="quantity">'+b("currency")(a.size,"$")+"</strong></p>"},a.initBubbles=function(){var b;if(b=e,b.children){d3.select("#bubble-chart svg").remove();var f=parseInt(d3.select("#bubble-chart").style("width"),10),g=parseInt(d3.select("#bubble-chart").style("height"),10),h=d3.tip().attr("class","bubble-chart-tip").offset([-10,0]).html(function(b){return a.getTooltip(b)}),i=d3.select("#bubble-chart").append("svg").attr("width",f).attr("height",g);i.call(h);var j=d3.layout.pack().size([f,g]).padding(8).value(function(a){return a.size}),k=j.nodes(b).filter(function(a){return!a.children}),l=i.selectAll("circle").data(k,function(a){return a.name});l.enter().append("circle").attr("fill",function(a){return a.fillColor}).attr("opacity",function(a){return a.opacity}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("r",function(a){return a.r}).on("mouseover",function(a){h.show(a),d3.select(this).transition().duration(750).attr("r",function(a){return 1.1*a.r})}).on("mouseout",function(a){h.hide(a),d3.select(this).transition().duration(750).attr("r",function(a){return 1*a.r})}).on("click",function(a){d.$apply(function(){c.path("/municipio/"+a.resourceId)})}).attr("class",function(a){return a.className})}},e=a.processData(a.chartData),a.chartData&&a.initBubbles(),a.$watch("chartData",function(b,c){b&&(a.processData(a.chartData),a.initBubbles())},!0),a.resize=function(){setTimeout(function(){a.initBubbles()},1500)},d3.select(window).on("resize",a.resize)};a.$inject=["$scope","$filter","$location","$rootScope"];var b=function(){return{controller:a,scope:{chartData:"="},template:'<div class="asec-chart" id="bubble-chart"></div>'}};app.directive("bubbleChart",b)}(),angular.module("asecApp").controller("HeaderCtrl",["$scope",function(a){}]),angular.module("asecApp").service("PageTitle",function(){}),angular.module("asecApp").service("MetaInformation",function(){});